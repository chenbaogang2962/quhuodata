- fetch_dataset:
    template_code: mt_day_13
    dataset_cate: raw
    datakit_pull_way: last_day
    ignore_null_error: true
    empty_df_record:
      加盟站ID: 0
      加盟站名称: '-'
      完成单(未剔除异常单): 0
      星级: 0
      得分: 0
      提前点送达订单数: 0
      15分钟超时订单数: 0
      不满意订单数: 0
      配送原因未完成数: 0
      一般超时单量(考核): 0
      严重超时单量(考核): 0
      提前点送达(复合)订单数: 0
      15分钟超时订单占比: 0
      不满意率: 0
      配送原因未完成率: 0
      复合准时率（考核）: 0
      meta_day: 0
      meta_month: 0
    columns:
      - 加盟站ID
      - 加盟站名称
      - 完成单(未剔除异常单)
      - 星级
      - 得分
      - 提前点送达(复合)订单数
      - 15分钟超时订单数
      - 不满意订单数
      - 配送原因未完成数
      - 一般超时单量(考核)
      - 严重超时单量(考核)
      - 提前点送达率(复合)
      - 15分钟超时订单占比
      - 不满意率
      - 配送原因未完成率
      - 复合准时率（考核）
      - meta_day
      - meta_month
    rename:
      加盟站ID: vendor_dc_id
      加盟站名称: dc_name
      完成单(未剔除异常单): total_order
      星级: star_level
      得分: total_score
      提前点送达(复合)订单数: advance_delivery_orders
      15分钟超时订单数: over_15_orders
      不满意订单数: dissatisfy_orders
      配送原因未完成数: unfinished_orders
      一般超时单量(考核): ordinary_over_time_orders
      严重超时单量(考核): serious_over_time_orders
      提前点送达率(复合): advance_delivery_ratio
      15分钟超时订单占比: over_15_ratio
      不满意率: dissatisfy_ratio
      配送原因未完成率: unfinished_ratio
      复合准时率（考核）: punctuality_ratio
      meta_day: book_day
      meta_month: book_month
- df_head: []
- add_cols:
    - advance_delivery_score: 0
- add_cols:
    - over_15_ratio_score: 0
- add_cols:
    - dissatisfy_ratio_score: 0
- add_cols:
    - unfinished_ratio_score: 0
- add_cols:
    - punctuality_ratio_score: 0
- add_cols:
    - avg_daily_order: 0
- add_cols:
    - punctuality_contains: 0
- add_cols:
    - punctuality_surplus: 0
- add_cols:
    - advance_delivery_contains: 0
- add_cols:
    - advance_delivery_surplus: 0
- add_cols:
    - over_15_contains: 0
- add_cols:
    - over_15_surplus: 0
- add_cols:
    - dissatisfy_contains: 0
- add_cols:
    - dissatisfy_surplus: 0
- add_cols:
    - unfinished_contains: 0
- add_cols:
    - unfinished_surplus: 0
- df_to_float:
    - advance_delivery_score
- df_to_float:
    - over_15_ratio_score
- df_to_float:
    - dissatisfy_ratio_score
- df_to_float:
    - unfinished_ratio_score
- df_to_float:
    - punctuality_ratio_score
- df_to_float:
    - avg_daily_order
- df_to_float:
    - punctuality_contains
- df_to_float:
    - punctuality_surplus
- df_to_float:
    - advance_delivery_contains
- df_to_float:
    - advance_delivery_surplus
- df_to_float:
    - over_15_contains
- df_to_float:
    - over_15_surplus
- df_to_float:
    - dissatisfy_contains
- df_to_float:
    - dissatisfy_surplus
- df_to_float:
    - unfinished_contains
- df_to_float:
    - unfinished_surplus
- str_strip_column:
    column: advance_delivery_ratio
    char: '%'
- df_to_float:
    - advance_delivery_ratio
- df_eval:
    - '[advance_delivery_ratio] = [advance_delivery_ratio] / 100'
- str_strip_column:
    column: over_15_ratio
    char: '%'
- df_to_float:
    - over_15_ratio
- df_eval:
    - '[over_15_ratio] = [over_15_ratio] / 100'
- str_strip_column:
    column: dissatisfy_ratio
    char: '%'
- df_to_float:
    - dissatisfy_ratio
- df_eval:
    - '[dissatisfy_ratio] = [dissatisfy_ratio] / 100'
- str_strip_column:
    column: unfinished_ratio
    char: '%'
- df_to_float:
    - unfinished_ratio
- df_eval:
    - '[unfinished_ratio] = [unfinished_ratio] / 100'
- str_strip_column:
    column: punctuality_ratio
    char: '%'
- df_to_float:
    - punctuality_ratio
- df_eval:
    - '[punctuality_ratio] = [punctuality_ratio] / 100'
- df_to_int:
    - vendor_dc_id
- run_py:
    - |
      df=to_df(df)
      df['vendor_dc_id']=[u'%s' % i for i in df[u'vendor_dc_id']]
      result=to_dd(df)
- stash_push_df: []
- fetch_dataset:
    template_code: mt_month_60
    dataset_cate: raw
    datakit_pull_way: last_day
    ignore_null_error: true
    empty_df_record:
      站点ID: '-'
      复合准时率X: 0
      复合准时率Y: 0
      复合准时率Z: 0
      配送原因未完成率X: 0
      配送原因未完成率Y: 0
      配送原因未完成率Z: 0
      不满意率X: 0
      不满意率Y: 0
      不满意率Z: 0
      提前点送达率X: 0
      提前点送达率Y: 0
      提前点送达率Z: 0
      15分钟超时订单占比X: 0
      15分钟超时订单占比Y: 0
      15分钟超时订单占比Z: 0
    columns:
      - 站点ID
      - 复合准时率X
      - 复合准时率Y
      - 复合准时率Z
      - 配送原因未完成率X
      - 配送原因未完成率Y
      - 配送原因未完成率Z
      - 不满意率X
      - 不满意率Y
      - 不满意率Z
      - 提前点送达率X
      - 提前点送达率Y
      - 提前点送达率Z
      - 15分钟超时订单占比X
      - 15分钟超时订单占比Y
      - 15分钟超时订单占比Z
    rename:
      站点ID: vendor_dc_id
      复合准时率X: X1
      复合准时率Y: Y1
      复合准时率Z: Z1
      配送原因未完成率X: X2
      配送原因未完成率Y: Y2
      配送原因未完成率Z: Z2
      不满意率X: X3
      不满意率Y: Y3
      不满意率Z: Z3
      提前点送达率X: X4
      提前点送达率Y: Y4
      提前点送达率Z: Z4
      15分钟超时订单占比X: X5
      15分钟超时订单占比Y: Y5
      15分钟超时订单占比Z: Z5
- df_to_int:
    - vendor_dc_id
- run_py:
    - |
      df=to_df(df)
      df['vendor_dc_id']=[u'%s' % i for i in df[u'vendor_dc_id']]
      result=to_dd(df)
- stash_push_df: []
- stash_join_df:
    how: right
    on: vendor_dc_id
    fillna: 0
    drop_stash: True
- set_meta_days_column:
    - 当月总天数
- run_py:
    - |
        df=to_df(df)
        df['days'] = df['book_day'].map(str).str[6:].map(int)
        result = to_dd(df)
- str_strip_column:
    column: X1
    char: '%'
- df_to_float:
    - X1
- df_eval:
    - '[X1] = [X1] / 100'
- str_strip_column:
    column: Y1
    char: '%'
- df_to_float:
    - Y1
- df_eval:
    - '[Y1] = [Y1] / 100'
- str_strip_column:
    column: Z1
    char: '%'
- df_to_float:
    - Z1
- df_eval:
    - '[Z1] = [Z1] / 100'
- str_strip_column:
    column: X2
    char: '%'
- df_to_float:
    - X2
- df_eval:
    - '[X2] = [X2] / 100'
- str_strip_column:
    column: Y2
    char: '%'
- df_to_float:
    - Y2
- df_eval:
    - '[Y2] = [Y2] / 100'
- str_strip_column:
    column: Z2
    char: '%'
- df_to_float:
    - Z2
- df_eval:
    - '[Z2] = [Z2] / 100'
- str_strip_column:
    column: X3
    char: '%'
- df_to_float:
    - X3
- df_eval:
    - '[X1] = [X1] / 100'
- str_strip_column:
    column: Y3
    char: '%'
- df_to_float:
    - Y3
- df_eval:
    - '[Y1] = [Y1] / 100'
- str_strip_column:
    column: Z3
    char: '%'
- df_to_float:
    - Z3
- df_eval:
    - '[Z3] = [Z3] / 100'
- str_strip_column:
    column: X4
    char: '%'
- df_to_float:
    - X4
- df_eval:
    - '[X4] = [X4] / 100'
- str_strip_column:
    column: Y4
    char: '%'
- df_to_float:
    - Y4
- df_eval:
    - '[Y4] = [Y4] / 100'
- str_strip_column:
    column: Z4
    char: '%'
- df_to_float:
    - Z4
- df_eval:
    - '[Z4] = [Z4] / 100'
- str_strip_column:
    column: X5
    char: '%'
- df_to_float:
    - X5
- df_eval:
    - '[X5] = [X5] / 100'
- str_strip_column:
    column: Y5
    char: '%'
- df_to_float:
    - Y5
- df_eval:
    - '[Y5] = [Y5] / 100'
- str_strip_column:
    column: Z5
    char: '%'
- df_to_float:
    - Z5
- df_eval:
    - '[Z5] = [Z5] / 100'